"use strict";(self.webpackChunkjavascript_framework_shop=self.webpackChunkjavascript_framework_shop||[]).push([[352],{893:(t,e,s)=>{s.a(t,(async(t,i)=>{try{s.d(e,{Z:()=>l});var n=s(771),a=s(811),r=s(319),o=s(156),c=t([r,o]);[r,o]=c.then?(await c)():c;class l extends n.Z{_router={};_page=1;_count=5;_data=[];constructor({router:t={},data:e=[],countBids:s=0}={}){super(),this._router=t,this._data=e,this._countBids=s,this._init()}get page(){return this._page}async _afterInit(){await this._loadData(),await this._updateData()}async _loadData(){this._page=this._getPage()}async _updateData(){r.Z.dispatch((0,o.pA)(this._data.slice(this._page*this._count-this._count,this._page*this._count)))}_initComponent(){this._component=document.createElement("ul"),this._component.classList.add("main-pagination"),this._component.append(...this._list())}_getPage(){const t=window.location.search.match(/\?page=(\d+)/);return t?t[1]:1}_list(){const t=this._router.getUri(),e=[];for(let s=1;s<=10;s++){const i=document.createElement("li");i.classList.add("main-pagination__item");let n="";this._getPage()===String(s)&&(n="main-pagination__link--active");const r=new a.Z({url:`${t}?page=${s}`,html:`${s}`,attributes:{class:`main-pagination__link ${n}`}}).component;i.append(r),e.push(i)}return e}_initListeners(){}}i()}catch(t){i(t)}}))},771:(t,e,s)=>{s.d(e,{Z:()=>i});class i{_component=null;_elements={};_components={};_abortController=new AbortController;constructor(){if("BaseComponent"===this.constructor.name)throw new TypeError("Абстрактный класс!")}get _template(){return""}get component(){return this._component}get elements(){return this._elements}_setComponents(t){this._components=t}_reloadComponents(t){this._setComponents(t),this._initComponents()}_init(){this._beforeInit().then(),this._initComponent(),this._initElements(),this._initComponents(),this._initListeners(),this._afterInit().then()}async _beforeInit(){}async _afterInit(){}_loadData(){}_updateData(){}_initComponent(){const t=document.createElement("div");t.innerHTML=this._template,this._component=t.firstElementChild||t}_initElements(t=this._component){t.querySelectorAll("[data-el]").forEach((t=>{const e=t.dataset.el;this._elements[e]=t}))}_initComponents(){for(const t of Object.keys(this._components)){let e=this._elements[t];const{component:s}="object"!=typeof this._components[t]||Array.isArray(this._components[t])?new this._components[t]:this._components[t];e&&s&&(s.dataset.el=e.dataset.el,this._elements[e.dataset.el]=s,e.insertAdjacentElement("beforebegin",s),e.remove(),e=null,this._initElements(s))}}_initListeners(){}update(t={}){for(const[e,s]of Object.entries(t))this._elements[e]&&(this._elements[e].innerHTML=s)}destroy(){this._remove(),this._removeListeners()}_remove(){this._component.innerHTML="",this._elements={}}_removeListeners(){this._abortController.abort()}}},44:(t,e,s)=>{s.d(e,{Z:()=>n});var i=s(771);class n extends i.Z{_layout=s.e(220).then(s.bind(s,220));_title="JavaScript framework";constructor(){super(),document.title="Главая страница"}get layout(){return this._layout}}},811:(t,e,s)=>{s.d(e,{Z:()=>a});var i=s(286),n=s(771);class a extends n.Z{static _links=[];constructor({url:t="",html:e="",attributes:s={},activeClass:n="active"}={}){super(),this._router=i.Z.instance,this._url=this._correctUrl(t),this._html=e,this._attributes=s,this._activeClass=n,this._init()}get router(){return this._router}get activeClass(){return this._activeClass}_correctUrl(t){return this._router.history===i.Z.createWebHashHistory()&&(t=t.replace(/^\//,"/#/")),t}_initComponent(){this._component=document.createElement("a"),this._url===this._router.getUri()&&this._component.classList.add(this._activeClass),this._component.setAttribute("href",this._url),this._component.innerHTML=this._html,Object.entries(this._attributes).forEach((([t,e])=>{this._component.setAttribute(t,`${e}`)})),a._links.push({link:this._component,activeClass:this._activeClass})}_initListeners(){this._component.addEventListener("click",(async t=>{t.preventDefault();const e=t.currentTarget.getAttribute("href");window.history.pushState(null,null,e),this._toggleClass(),await this._router.render()})),window.addEventListener(this._router.history,(()=>this._toggleClass()),{signal:this._abortController.signal})}_toggleClass(){a._links.forEach((({link:t,activeClass:e})=>{new URL(t.href).pathname===this._router.getUri()?t.classList.add(e):t.classList.remove(e)}))}}},141:(t,e,s)=>{s.d(e,{Z:()=>i});class i{static _initialization=!1;_options={};_baseUrl="";constructor(){if(!i._initialization)throw new TypeError("Нельзя напрямую создать экземпляр данного класса")}static create(t={}){i._initialization=!0;const e=new i;return i._initialization=!1,e._baseUrl=t.baseUrl??"",delete t.baseUrl,e._options=t,e}_response=async(t,e={})=>{try{const s=await fetch(t,e);return await s.json()}catch(t){throw t}};get(t=""){return t=new URL(t,this._baseUrl),this._response(t.href,this._options)}post(t="",e={}){return t=new URL(t,this._baseUrl),this._options={...this._options,method:"post",body:e},this._response(t.href,this._options)}}},215:(t,e,s)=>{s.d(e,{Z:()=>i});class i{_reducers=[];_state={};_listeners={};constructor(t=[],e={}){this._reducers=t,this._state=e}getState(t=""){return this._state[t]?this._state[t]:this._state}_setState(t){this._state=t}subscribe(t,e){return this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),()=>{this._listeners=this._listeners[t].filter((t=>t!==e))}}dispatch(t){for(const e of this._reducers){const s=e(this.getState(),t);if(s){this._setState(s);const e=this._listeners[t.type];if(e){const t=this.getState();for(const s of e)s(t)}}}}}},352:(t,e,s)=>{s.a(t,(async(t,i)=>{try{s.r(e),s.d(e,{default:()=>p});var n=s(44),a=s(531),r=s(554),o=s(893),c=s(319),l=s(156),_=t([o,c,l]);[o,c,l]=_.then?(await _)():_;const{loadBids:h}=r.default;class p extends n.Z{_router={};constructor({router:t}){super(),document.title=`Страница заявок - ${this._title}`,this._router=t,this._init()}async _afterInit(){await this._loadData(),await this._updateData()}async _loadData(){c.Z.subscribe(l.sH,(t=>{this.update({content:this._list(t.bids)})}))}async _updateData(){this._reloadComponents({pagination:new o.Z({router:this._router,data:await h(),countBids:c.Z.getState("countBids")})})}get _template(){return'\n      <div class="bids-page">\n        <div class="container">\n          <h1 class="bids-page__title" data-el="title">Заявки</h1>\n          <p class="bids-page__desc"><span style="color: red;">Внимание!!!</span> Данные заявок берутся из открытого стороннего api. Возможно присутствие нецензурной лексики. <br> Для добавления новой заявки перейдите в любой товар и заполните форму, нажав на кнопку <b>"Забронировать"</b>.</p>\n\n          <ul class="bids-page__list">\n            <li class="bids-page__item bids-page__item--header">\n              <p class="bids-page__name">Имя</p>\n              <p class="bids-page__phone">Телефон</p>\n            </li>\n          </ul>\n          <ul class="bids-page__list" data-el="content"></ul>\n\n          <div class="bids-page__pagination">\n            <div data-el="pagination"></div>\n          </div>\n        </div>\n      </div>\n    '}_list(t={}){return t.map((t=>{const{name:e,phone:s}=(0,a.I)(t);return`\n        <li class="bids-page__item">\n          <p class="bids-page__name">${e}</p>\n          <p class="bids-page__phone">${s}</p>\n        </li>\n      `})).join("")}_initListeners(){}}i()}catch(t){i(t)}}))},156:(t,e,s)=>{s.a(t,(async(t,i)=>{try{s.d(e,{GW:()=>l,YU:()=>c,pA:()=>r,sH:()=>a});var n=s(554);const{loadBids:t}=n.default,a="REFRESH_BIDS",r=t=>({type:a,bids:t}),o=await t(),c={bids:o,countBids:o.length},l=(t,e)=>e.type===a?(t.bids=e.bids,{...t}):null;i()}catch(t){i(t)}}),1)},214:(t,e,s)=>{s.d(e,{Ap:()=>a,Hn:()=>r,IR:()=>n,Uw:()=>i});const i="TOGGLE_FAVOURITE",n=t=>({type:i,favourite:t}),a={favourites:JSON.parse(localStorage.getItem("favourites"))??[]},r=(t,e)=>{if(e.type===i){if(t.favourites.includes(e.favourite)){const s=t.favourites.filter((t=>t!==e.favourite));return localStorage.setItem("favourites",JSON.stringify(s)),{...t,favourites:s}}return t.favourites.push(e.favourite),localStorage.setItem("favourites",JSON.stringify(t.favourites)),{...t}}return null}},715:(t,e,s)=>{s.a(t,(async(t,i)=>{try{s.d(e,{LY:()=>h,MN:()=>c,U3:()=>_,Xm:()=>r,dj:()=>a,dq:()=>o,sx:()=>l,uD:()=>p});var n=s(42);const{loadAllProducts:t}=n.default,a="SUBMIT_FILTER",r="RESET_FILTER",o="SORT_FILTER",c=t=>({type:a,product:t}),l=()=>({type:r}),_=t=>({type:o,product:t}),h={products:await t()},p=(t,e)=>{switch(e.type){case a:case o:return t.products=e.product,{...t};case r:return{...t,...h};default:return null}};i()}catch(t){i(t)}}),1)},838:(t,e,s)=>{s.d(e,{dw:()=>r,kI:()=>n,v7:()=>a,xe:()=>i});const i="SORT_PRODUCT",n=t=>({type:i,product:t}),a={directions:{complex:"asc",rooms:"asc",square:"asc",priceSqM:"asc",priceTotal:"asc"}},r=(t,e)=>e.type===i?(t.products=e.product,{...t}):null},554:(t,e,s)=>{s.d(e,{default:()=>r});var i=s(141);const n=i.Z.create({baseUrl:"https://jsproject.webcademy.ru",credentials:"omit",headers:{"Content-Type":"application/json; charset=UTF-8"}}),a=i.Z.create({baseUrl:"https://jsproject.webcademy.ru",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),r={addBid:t=>n.post("/bidnew",t),loadBids:()=>a.get("/bids")}},42:(t,e,s)=>{s.d(e,{default:()=>n});const i=s(141).Z.create({baseUrl:"https://jsproject.webcademy.ru",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),n={loadAllProducts:()=>i.get("/items"),loadProduct:t=>i.get(`/items/${t}`),loadProductById:t=>t.length<1?[]:i.get(`/items?ids=${t.join(",")}`),loadFilterProducts:t=>i.get(t)}},319:(t,e,s)=>{s.a(t,(async(t,i)=>{try{s.d(e,{Z:()=>u});var n=s(215),a=s(715),r=s(838),o=s(156),c=s(214),l=t([a,o]);[a,o]=l.then?(await l)():l;const _=[a.uD,r.dw,o.GW,c.Hn],h={...a.LY,...r.v7,...o.YU,...c.Ap},p=new n.Z(_,h),d=Symbol.for("storeKey");globalThis[d]=p;const u=globalThis[d];i()}catch(t){i(t)}}))},531:(t,e,s)=>{s.d(e,{A:()=>i,I:()=>n});const i=(t,e)=>e[(t=Math.abs(t))%100>4&&t%100<20?2:[2,0,1,1,1,2][t%10<5?t%10:5]],n=t=>{const e={};for(const s in t)if(t.hasOwnProperty(s)){e[s.replace(/_(\w)/g,((t,e)=>e.toUpperCase()))]=t[s]}return e}}}]);